$(document).ready( function() {
  var subsetEditPanel = new SubsetEditChildrenPanel(subset_children_url, 1000, loadCallback, lockCallback);
  var sourceChildrenPanel = new SubsetSourceChildrenPanel(source_children_url, 1000, subsetEditPanel, loadCallback, lockCallback);
  var timer = new Timer($('#edit_lock_token').val(), "imh_header", $('#warning_timeout').val());

  function loadCallback(obj){
    obj.isLoaded = true;
    if(subsetEditPanel.isLoaded && sourceChildrenPanel.isLoaded){
      subsetEditPanel.markExistingItems();
    }
  }

  function lockCallback() {
    if(!timer.expired)
      timer.extendLock();
  }

  $("#edit-properties").on('click', function(){
    lockCallback();
  });
});
