<%= javascript_include_tag 'standard_datatable' %>
<% top_level_breadcrumb ("User Settings") %>
<h3>User Settings: <%= current_user.email %></h3>
<div class="row">
	<div class="col-md-8">
		<table id="main" class="table table-striped table-bordered table-condensed">
			<thead>
				<tr>
		    	<th>Setting</th>
		    	<th>Current Value</th>
		    	<th>Options</th>
		  	</tr>
			</thead>
			<tbody>
				<% @settings.each do |key, value| %>
					<% md = @settings_metadata[key] %>
					<tr>
			    	<td><%= md[:label] %></td>
			    	<% if md[:type] == "enum" %>
			    		<% md[:values].each do |option| %>
			    			<% if option == value %>
			    				<td>
			    			 		<button type="button" class="btn btn-success btn-xs disabled"><%= value %></button>
			    			 	</td>
			    			<% end %>
			    		<% end %>
			    		<td>
				  			<% md[:values].each do |option| %>
			    				<% if option != value %>
			    					<%= link_to option, user_setting_path(:id => current_user.id, :user_settings => {:name => key, :value => option}), :method => :put, :class => "btn btn-primary btn-xs" %>
			    				<% end %>
			    			<% end %>
			    		</td>			    			
			    	<% elsif md[:type] == "coded" %>
			    		<% md[:values].each do |value_key, option| %>
			    			<% if option.to_s == value %>
			    				<td>
			    			 		<button type="button" class="btn btn-success btn-xs disabled"><%= value_key %></button>
			    			 	</td>
			    			<% end %>
			    		<% end %>
			    		<td>
				  			<% md[:values].each do |value_key, option| %>
			    				<% if option.to_s != value %>
			    					<%= link_to value_key, user_setting_path(:id => current_user.id, :user_settings => {:name => key, :value => option}), :method => :put, :class => "btn btn-primary btn-xs" %>
			    				<% end %>
			    			<% end %>
			    		</td>			    			
			    	<% end %>
				  </tr>
				<% end %>
			</tbody>
		</table>
		<%= link_to "Password", edit_user_registration_path(@user), :class => "btn btn-primary" %>
	</div>
</div>