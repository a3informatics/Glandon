<%= javascript_include_tag 'standard_datatable' %>
<% second_level_breadcrumb("Users", users_path, "Edit") %>
<div class="row">
	<div class="col-md-4">
		<div class="panel panel-default">
			<div class="panel-heading">
				<h3 class="panel-title">Current User: <%= @user.email %></h3>
			</div>
  		<div class="panel-body">
    		<p>There are set number of role combinations. They can be set using the buttons to the right.</p>
    		<table id="version_info" class="table table-striped table-condensed">
      		<tbody>
		      	<tr>
		          <td><strong>User Email:</strong></td><td><%= @user.email %></td>
		        </tr>
		        <tr>
		          <td><strong>Current Roles:</strong></td><td><%= @user.role_list_stripped %></td>
		        </tr>
		        <tr>
		          <td><strong>Login Count:</strong></td><td><%= @user.sign_in_count %></td>
		        </tr>
		      </tbody>
    		</table>
    		<%= link_to "Close", users_path, :class => "btn btn-primary" %>
  		</div>
		</div>
	</div>
	<% roles = Role.list %>
	<% roles_bar = roles.except(:sys_admin) %>
	<div class="col-md-4">
		<% roles_bar.each do |role, info| %>
			<% display_text = info[:display_text] %>
			<div class="panel panel-success">
				<div class="panel-heading"><%= display_text %> Role</div>
	  		<div class="panel-body">
	    		<p><%= Role.description(role) %></p>
	    		<%= link_to "Set #{display_text} Role", user_path(@user, :user => { :role_ids => [info[:id]] }), method: :put, :class => "btn btn-success btn-block" %>
	  		</div>
			</div>
		<% end %>
	</div>

	<div class="col-md-4">
		<% roles_bar.each do |role, info| %>
			<% display_text = info[:display_text] %>
			<% if Role.with_sys_admin(role) %>
				<div class="panel panel-warning">
					<div class="panel-heading"><%= display_text %> & System Admin Role</div>
		  		<div class="panel-body">
		    		<p><%= Role.description(role) %></p>
		    		<%= link_to "Set #{display_text} & System Admin Role", user_path(@user, :user => { :role_ids => [roles[:sys_admin][:id], info[:id]] }), method: :put, :class => "btn btn-warning btn-block" %>
		  		</div>
				</div>
			<% end %>
		<% end %>
		<div class="panel panel-warning">
			<div class="panel-heading">System Admin Role</div>
  		<div class="panel-body">
    		<p>This access sets only system administration rights.</p>
    		<%= link_to "Set System Admin Role", user_path(@user, :user => { :role_ids => [roles[:sys_admin][:id]] }), method: :put, :class => "btn btn-warning btn-block" %>
  		</div>
		</div>
	</div>
</div>
