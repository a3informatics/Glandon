<%= javascript_tag 'setPageTitle("Edit Subset: '+@subset_mc.notation+' ('+@subset_mc.has_identifier.identifier+')")' %>
<% third_level_breadcrumb(:thesauri, @subset_mc, history_thesauri_index_path({thesauri: {identifier: @subset_mc.scoped_identifier, scope_id: @subset_mc.scope.id}})) %>

<%= javascript_include_tag 'thesauri/managed_concepts/edit_subset', 'shared/timer', 'unload',
    'shared/thesauri/managed_concepts/subset_source_children_panel', 'shared/thesauri/managed_concepts/subset_edit_children_panel' %>
<%= stylesheet_link_tag 'thesauri/managed_concepts/edit_subset', 'shared/table_select', 'shared/datatables_loading' %>

<%= javascript_tag "var clChildrenUrl = '#{children_thesauri_managed_concept_path({id: @source_mc})}',
                        subsetChildrenUrl = '#{list_children_thesauri_subset_path(@subset)}',
                        addToSubsetUrl = '#{add_thesauri_subset_path(@subset)}',
                        removeFromSubsetUrl = '#{remove_thesauri_subset_path(@subset)}',
                        removeAllFromSubsetUrl = '#{remove_all_thesauri_subset_path(@subset)}',
                        moveAfterSubsetUrl = '#{move_after_thesauri_subset_path(@subset)}'; "%>
<div class="row">
  <%= render layout: "shared/headers/header_codelist", :locals => {:item => @subset_mc, :context => @ct, :badge => "CL"} do %>
    <div class="actions-wrap">
      <%= render partial: "shared/buttons/ico_btn_secondary", :locals => {link_path: "#", id: "timeout",
        icon: "icon-lock", btn_text: "", dt_toggle: "", disabled: false } %>
      <%= render partial: "shared/buttons/ico_btn_secondary", :locals => {link_path: @close_path, id: "close",
        icon: "icon-long-arrow", btn_text: "Return", dt_toggle: "", disabled: false } %>

      <%= render layout: "shared/context_menu/con_menu", :locals => {menu_id: "header-con-menu", color: "blue", side: "left"} do %>
        <%= render partial: "shared/context_menu/con_menu_item", :locals => {link_path: "#", id: "edit-properties",
          icon: "icon-edit", text: "Edit properties", dt_toggle: "modal", disabled: false } %>
        <%= render partial: "shared/context_menu/con_menu_item", :locals => {link_path: @edit_tags_path, id: "edit-tags",
          icon: "icon-tag", text: "Edit tags", dt_toggle: "", disabled: false, target: "_blank" } %>
        <%= render partial: "shared/context_menu/con_menu_item", :locals => {link_path: "#change-notes-modal", id: "change-notes-button",
          icon: "icon-note", text: "Change notes", dt_toggle: "modal", disabled: false } %>
      <% end %>
    </div>
  <% end %>

  <%= render partial: "shared/thesauri/edit_properties_modal", :locals => {modal_id: "subset", item: @subset_mc} %>
  <%= render partial: "shared/annotation/change_notes/change_notes_modal", :locals => {item_name: @subset_mc.identifier, item_id: @subset_mc.id, item_notes_url: change_notes_iso_concept_path(@subset_mc.id)} %>

</div>
<div class="row">
  <div class="col-md-12 card">
    <div class="card-header">
      Edit Subset
    </div>
    <div class="card-content">
      <div class="editor-wrap">
        <%= render partial: "shared/iso_managed/edit_subset_panel", :locals => {panel_title: "Source Code List (#{@source_mc.has_identifier.identifier})",
          table_id: "source_children_table", is_editing_panel: false, info: "Click on an item to add/remove <br> it from the subset.".html_safe} %>
        <%= render partial: "shared/iso_managed/edit_subset_panel", :locals => {panel_title: "Ordered Subset (#{@subset_mc.has_identifier.identifier})",
          table_id: "subset_children_table", is_editing_panel: true, info: "You can change the order <br> of items by dragging them.".html_safe} %>
      </div>
    </div>
  </div>
</div>
<input type="hidden" id="edit_lock_token" value="<%= @token.id %>">
<input type="hidden" id="warning_timeout" value="<%= current_user.edit_lock_warning %>">
