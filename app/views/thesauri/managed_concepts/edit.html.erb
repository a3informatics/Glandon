<%= javascript_tag 'setPageTitle("Edit: '+@thesaurus_concept.notation+' ('+@thesaurus_concept.has_identifier.identifier+')")' %>

<%= javascript_include_tag 'thesauri/managed_concepts/edit', 'shared/timer', 'unload_v2' %>
<%= javascript_tag "var addChildPath = '#{add_child_thesauri_managed_concept_path(@thesaurus_concept)}',
                        childrenPath = '#{children_thesauri_managed_concept_path(@thesaurus_concept)}',
                        updatePath = '/thesauri/unmanaged_concepts/:id',
                        parentId = '#{@thesaurus_concept.id}';"%>

<div class="row">
  <%= render layout: "shared/headers/header_codelist", :locals => {:item => @thesaurus_concept, :context => @thesaurus, :badge => "CL"} do %>
    <div class="actions-wrap">
      <%= render partial: "shared/buttons/ico_btn_secondary", :locals => {link_path: "#", id: "timeout",
        icon: "icon-lock", btn_text: "", dt_toggle: "", disabled: false } %>
      <%= render partial: "shared/buttons/ico_btn_secondary", :locals => {link_path: @close_path, id: "close",
        icon: "icon-long-arrow", btn_text: "Return", dt_toggle: "", disabled: false } %>

      <%= render layout: "shared/context_menu/con_menu", :locals => {menu_id: "header-con-menu", color: "blue", side: "left"} do %>
          <%= render partial: "shared/context_menu/con_menu_item", :locals => {link_path: "#", id: "edit-properties-button",
            icon: "icon-edit", text: "Edit properties", dt_toggle: "", disabled: false } %>
          <%= render partial: "shared/context_menu/con_menu_item", :locals => {link_path: @edit_tags_path, id: "edit-tags-button",
            icon: "icon-tag", text: "Edit tags", dt_toggle: "", disabled: false, target: "_blank" } %>
          <% if @thesaurus_concept.ranked? %>
            <%= render partial: "shared/context_menu/con_menu_item", :locals => {link_path: "#rank-items-modal", id: "edit-ranks-button",
              icon: "icon-rank", text: "Edit ranks", dt_toggle: "modal", disabled: false } %>
          <% else %>
            <%= render partial: "shared/thesauri/managed_concepts/rank/enable_rank", :locals => {item: @thesaurus_concept} %>
          <% end %>
          <%= render partial: "shared/context_menu/con_menu_item", :locals => {link_path: "#change-notes-modal", id: "change-notes-button",
            icon: "icon-note", text: "Change notes", dt_toggle: "modal", disabled: false } %>
      <% end %>
    </div>
  <% end %>
</div>

<%= render partial: "shared/thesauri/edit_properties_modal", :locals => {modal_id: 'codelist', item: @thesaurus_concept} %>
<%= render partial: "shared/annotation/change_notes/change_notes_modal", :locals => {item_name: @thesaurus_concept.identifier, item_id: @thesaurus_concept.id, item_notes_url: change_notes_iso_concept_path(@thesaurus_concept.id)} %>
<%= render partial: "shared/thesauri/managed_concepts/rank/edit_ranks", :locals => {item: @thesaurus_concept} %>

<div class="row">
  <div class="col-md-12">
    <%= render partial: "shared/thesauri/editor_panel", :locals => {title: "Code List Items"} %>
  </div>
</div>
<div class="row">
  <div class="col-md-4">
    <%= render partial: "shared/thesauri/new_panel", :locals => {klass: Thesaurus::UnmanagedConcept, title: "New Code List Item", prefix: @parent_identifier} %>
  </div>
</div>
<input type="hidden" id="parameters_key" value="thesauri">
<input type="hidden" id="edit_lock_token" value="<%= @token.id %>">
<input type="hidden" id="warning_timeout" value="<%= current_user.edit_lock_warning %>">
<input type="hidden" id="close_path" value="<%= @close_path %>">
