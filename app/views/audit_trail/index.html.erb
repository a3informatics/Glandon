<%= javascript_include_tag 'standard_datatable' %>
<h3>Index: Audit Trail</h3>
	<div class="row">
		<div class="col-md-9">
			<h4>Audit Trail</h4>
			<table id="main" class="table table-striped table-bordered table-condensed">
			  	<thead>
					<tr>
				  		<th>Date Time</th>
				    	<th>User</th>
				    	<th>Owner</th>
				    	<th>Identifier</th>
				    	<th>Version</th>
				    	<th>Event</th>
				    	<th>Details</th>
				  	</tr>
				</thead>
				<tbody>
					<% @items.each do |item| %>
					  	<tr>
					    	<td><%= item.date_time.to_datetime %></td>
						    <td><%= item.user %></td>
						    <td><%= item.owner %></td>
						    <td><%= item.identifier %></td>
						    <td><%= item.version %></td>
						    <td><%= item.event_to_s %></td>
						    <td><%= item.description %></td>
				  		</tr>
					<% end %>
				</tbody>
			</table>
			<%= link_to "All", audit_trail_index_path, :class => "btn btn-primary" %>
		</div>
		<div class="col-md-3">
			<div class="panel panel-default">
	      <div class="panel-heading">
	          <h3 class="panel-title">Search</h3>
	      </div>
	      <div class="panel-body">
					<%= form_for AuditTrail.new, :url => search_audit_trail_index_path do |f| %>
						<div class="form-group">
						    <%= f.label :user, "User:" %><br />
						    <%= f.select(:user, options_for_select(@users.map{ |u| [u.email, u.email]}, @defaults[:user]), {}, {:class => 'form-control'}) %>
						</div>
						<div class="form-group">
						    <%= f.label :owner, "Owner:" %><br />
						    <%= f.select(:owner, options_for_select(@owners.map{ |u| [u.shortName, u.shortName]}, @defaults[:owner]), {}, {:class => 'form-control'}) %>
						</div>
						<div class="form-group">
						    <%= f.label :identifier, "Identifier:" %><br />
						    <%= f.text_field :identifier, class: "form-control" %>
						</div>
						<div class="form-group">
						    <%= f.label :event, "Event:" %><br />
						    <%= f.select(:event, options_for_select(@events.map{ |key, u| [AuditTrail.event_to_s(u), u]}, @defaults[:event]), {}, {:class => 'form-control'}) %>
						</div>
						<%= f.submit "Submit", class: "btn btn-default btn-primary" %>  				
					<% end %>
				</div>
			</div>
		</div>
	</div>
</div>
