<%= javascript_tag "var changes_path = '/cdisc_terms/:id/changes';" %>
<%= javascript_include_tag 'jquery','jquery-ui.min.js' %>
<%= javascript_include_tag 'shared/cdisc_term/index_panel', 'shared/timeline_slider', 'shared/alph_slider', 'cdisc_term/index'%>
<%= stylesheet_link_tag 'custom/alph_filter','custom/dates_selector', media: 'all' %>

<style>
  .rowpad {
    padding-top: 20px;
  }

  html,body { min-width: 1000px; }

  #results_div .ico-btn{
    margin: 20px auto 0px auto;
 }
  #results_div .icon-filter{  margin-left:4px; }


</style>
<div class="row rowpad">
  <div class="col-md-12">
    <div class="btns-wrap">
      <a href="<%= history_cdisc_terms_path %>" class="btn btn-primary ico-btn shadow-small">
        <span class="icon-browse-all text-xlarge"></span>
        <span class="ico-btn-text">Browse every version of CDISC CT</span></a>
      <a href="<%= changes_thesauri_path(@current_id) %>" class="btn btn-primary ico-btn shadow-small">
        <span class="icon-see-changes text-xlarge"></span>
        <span class="ico-btn-text">See all the Changes across versions</span></a>
      <a href="<%= submission_thesauri_path(@current_id) %>" class="btn btn-primary ico-btn shadow-small">
        <span class="icon-submission-changes text-xlarge"></span>
        <span class="ico-btn-text">See just the Submission value changes across versions</span></a>
      <a href="<%= search_thesauri_path(@latest_id) %>" class="btn btn-primary ico-btn shadow-small">
        <span class="icon-search-latest text-xlarge"></span>
        <span class="ico-btn-text">Search the latest version of CDISC CT</span></a>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-md-12 card">
      <h3 class="card-header">Changes in CDISC CT versions</h3>
      <div class="card-content">
        <div class="row">
          <center>
            <span class="text-medium text-small font-light">Select version timespan by dragging the sliders below:</span><br><br>
            <!-- TIMELINE SELECTOR START -->
            <div class="timeline-outer-container">
              <div class="timeline-container">
                <div class="timeline-start-end"><%= @versions_yr_span[0] %></div>
                <div class="timeline"></div>
                <!-- RENDER POINTS ON TIMELINE  -->
                <% @versions_normalized.each_with_index do |x, index| %>
                  <div class="timeline-point bg-prim-bright shadow-small <%= if index == 0 || index == @versions_normalized.length-1 then 'point-highlight' end %> ttip"
                       style="left: <%= x %>%;">
                    <span class="ttip-text text-small text-light shadow-small" data-index="<%= @versions[index][:id] %>"><%= @versions[index][:date] %></span>
                  </div>
                <% end %>
                <div class="timeline-start-end"><%= @versions_yr_span[1] %></div>
              </div>
              <!-- TIMELINE CONTROLS -->
              <div class="timeline-container timeline-controls">
                <div id="timeline-start-btn" class="timeline-date-btn" style="left: -51px;">
                  from <span class="date-txt" id="start-date-txt"><%= @versions[0][:date] %></span></div>
                <div id="timeline-end-btn" class="timeline-date-btn" style="right: -51px;">
                  to <span class="date-txt" id="end-date-txt"><%= @versions[-1][:date] %></span></div>
              </div>
            </div>
            <!-- TIMELINE SELECTOR END -->
            <div class="btn ico-btn shadow-small highlight" id="go_button">
              <span class="icon-browse-all text-xlarge"></span><span class="ico-btn-text">Display</span>
            </div>
          </center>
        </div>
        <div class="row rowpad">
          <div class="col-md-12">
              <div class="panel-body">
                <div id="results_div">
                  <div class="col-md-4">
                    <%= render partial: "shared/ico_header", :locals => { header_title: "Created Items", img_path: "cdisc_terms/ct_badge_plus"} %>
                    <%= render partial: "shared/alphabetical_filter", :locals => { btn_id: "btn_f_created"} %>
                      <div class="list-wrap" id="created_div">
                        <div class='text-medium font-light text-centered no-results-msg' hidden>No results</div>
                      </div>
                  </div>
                  <div class="col-md-4">
                    <%= render partial: "shared/ico_header", :locals => { header_title: "Updated Items", img_path: "cdisc_terms/ct_badge_update"} %>
                    <%= render partial: "shared/alphabetical_filter", :locals => { btn_id: "btn_f_updated"} %>
                    <div class="list-wrap" id="updated_div">
                      <div class='text-medium font-light text-centered no-results-msg' hidden>No results</div>
                    </div>
                  </div>
                  <div class="col-md-4">
                    <%= render partial: "shared/ico_header", :locals => { header_title: "Deleted Items", img_path: "cdisc_terms/ct_badge_minus"} %>
                    <%= render partial: "shared/alphabetical_filter", :locals => { btn_id: "btn_f_deleted"} %>
                    <div class="list-wrap" id="deleted_div">
                      <div class='text-medium font-light text-centered no-results-msg' hidden>No results</div>
                    </div>
                  </div>
                </div>
                <div id="spinner_div"><p class="text-center text-medium font-light"><img src="<%= asset_path('loading.svg') %>" class="loading-medium"><br/> Fetching results...</p></div>
              </div>
          </div>
        </div>
      </div>
      </div>
