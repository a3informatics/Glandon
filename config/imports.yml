defaults: &defaults
  imports: &default_imports
    # cdisc_adam_ig: 
    #   title: CDISC ADaM IG Import - Excel
    #   background: true
    #   description: This facilty allows for the ADaM Implementation Guide to be imported from an MS Excel file.
    #   link_text: "Import CDISC ADaM IG"
    #   link_path: "/imports/adam_igs/new?imports[file_type]=0"
    cdisc_term: 
      title: CDISC Terminology Import - Excel
      background: true
      description: This facilty allows for the CDISC Terminology to be imported from one or more MS Excel files.
      link_text: "Import CDISC Term (Excel)"
      link_path: "/imports/cdisc_terms/new?imports[file_type]=0"
    cdisc_term_api: 
      title: CDISC Terminology Import - API
      background: true
      description: This facilty allows for the CDISC Terminology to be imported usig the CDISC API.
      link_text: "Import CDISC Term (API)"
      link_path: "/imports/cdisc_terms/new?imports[file_type]=3"
    # cdisc_change_instructions: 
    #   title: CDISC Terminology Change Instructions - Excel
    #   background: true
    #   description: This facilty allows for the CDISC Terminology change instructions to be imported from one or more MS Excel files.
    #   link_text: "Import Change Instructions"
    #   link_path: "/imports/change_instructions/new?imports[file_type]=0"
    # form_als:
    #   title: Form Import - ALS
    #   background: true
    #   description: This facilty allows for a form to be imported from an ALS file.
    #   link_text: "Import Form from ALS"
    #   link_path: "/imports/crfs/new?imports[file_type]=2"
    # form_odm:
    #   title: Form Import - ODM
    #   background: true
    #   description: This facilty allows for a form to be imported from an ODM XML file.
    #   link_text: "Import Form from ODM"
    #   link_path: "/imports/crfs/new?imports[file_type]=1"
    # term_excel:
    #   title: Import Terminology - EXCEL
    #   background: true
    #   description: This facilty allows for a form to be imported from an MS Excel file.
    #   link_text: "Import Terminology from Excel"
    #   link_path: "/imports/terms/new?imports[file_type]=0"
    # term_odm:
    #   title: Import Terminology - ODM
    #   background: true
    #   description: This facilty allows for a form to be imported from an ODM XML file.
    #   link_text: "Import Terminology from ODM"
    #   link_path: "/imports/terms/new?imports[file_type]=1"
  processing: &default_processing
    cdisc_change_instructions: 
      sheets: 
        main:
          selection:
            first: true
          sheet:
            actions: []
            header_row:
              - "Release Date"
              - "Request Code"
              - "Change Type"
              - "NCI Code"
              - "CDISC Term Type"
              - "CDISC Codelist (Short Name)"
              - "CDISC Codelist (Long Name)"
              - "Change Summary"
              - "Original"
              - "New"
              - "Change Implementation Instructions"
              - "Use"
              - "Prev Codelist"
              - "Prev Term"
              - "New Codelists"
              - "New Terms"
              - "Comment"
          row:
            condition:
              method: column_affirmative?
              column: 12
          columns: 
          - 
            label: "Release Date"
            actions: []
          - 
            label: "Request Code"
            actions: []
          - 
            label: "Change Type"
            actions: []
          - 
            label: "NCI Code"
            actions: []
          - 
            label: "CDISC Term Type"
            actions: []
          - 
            label: "CDISC Codelist (Short Name)"
            actions: []
          - 
            label: "CDISC Codelist (Long Name)"
            actions: []
          - 
            label: "Change Summary"
            actions: []
          - 
            label: "Original"
            actions: []
          - 
            label: "New"
            actions: []
          - 
            label: "Change Implementation Instructions"
            actions: []
          - 
            label: "Use"
            actions: []
          - 
            label: "Prev Codelist"
            actions:
              -
                method: c_codes?
                object: NA
                klass: NA
                map: {}
                additional: 
                  token: ","
              -
                method: create_item
                object: parent
                klass: "Import::ChangeInstruction::Instruction"
                map: {}
              -
                method: tokenize_and_set_property
                object: parent
                property: previous_parent
                can_be_empty: false
                additional: 
                  token: ","
          - 
            label: "Prev Term"
            actions:
              -
                method: c_codes?
                object: NA
                klass: NA
                can_be_empty: true
                map: {}
                additional: 
                  token: ","
              -
                method: tokenize_and_set_property
                object: parent
                property: previous_children
                can_be_empty: true
                additional: 
                  token: ","
          - 
            label: "New Codelists"
            actions:
              -
                method: c_codes?
                object: NA
                klass: NA
                map: {}
                additional: 
                  token: ","
              -
                method: tokenize_and_set_property
                object: parent
                property: current_parent
                additional: 
                  token: ","
          - 
            label: "New Terms"
            actions:
              -
                method: c_codes?
                object: NA
                klass: NA
                can_be_empty: true
                map: {}
                additional: 
                  token: ","
              -
                method: tokenize_and_set_property
                object: parent
                property: current_children
                can_be_empty: true
                additional: 
                  token: ","
          - 
            label: "Comment"
            actions: 
              -
                method: set_property
                object: parent
                property: description
                can_be_empty: false
                map: {}
              -
                method: check_valid
                object: parent
                map: {}
    cdisc_adam_ig: 
      sheets: 
        main:
          selection:
            label: ADaM-IG
          sheet:
            actions: []
            header_row: 
              - "Data Structure Name"
              - "Dataset Name"
              - "Variable Group"
              - "Variable Name" 
              - "Variable Label"
              - "Type"
              - "Codelist/Controlled Terms"
              - "Core"
              - "CDISC Notes"
          columns: 
          - 
            label: "Data Structure Name"
            actions:
              -
                method: create_parent
                object: parent
                klass: AdamIgDataset
                map:
                  SUBJECT LEVEL ANALYSIS DATASET: ADAMIG ADSL
                  BASIC DATA STRUCTURE: ADAMIG BDS
              -
                method: set_property
                object: parent
                property: label
                map:
                  SUBJECT LEVEL ANALYSIS DATASET: Subject Level Analysis Dataset
                  BASIC DATA STRUCTURE: Basic Data Structure
          - 
            label: "Dataset Name"
            actions: []
          - 
            label: "Variable Group"
            actions: []
          - 
            label: "Variable Name" 
            actions:
              -
                method: create_child
                object: child
                klass: AdamIgDataset::Variable
                map: {}
              -
                method: ordinal
                object: child
                property: ordinal
                map: {}
              -
                method: set_property
                object: child
                property: name
                map: {}
          - 
            label: "Variable Label"
            actions:
              -
                method: set_property
                object: child
                property: label
                map: {}
          - 
            label: "Type"
            actions:
              -
                method: create_classification
                object: child
                property: datatype
                map:
                  Char: Character
                  Num: Numeric
          - 
            label: "Codelist/Controlled Terms"
            actions:
              - 
                method: ct_reference
                object: child
                property: ct
                map: {}
              -
                method: ct_other
                object: child
                property: ct_notes
                map: {}
          - 
            label: "Core"
            actions:
              -
                method: create_classification
                object: child
                property: compliance
                map:
                  Req: Required
                  Perm: Permissible
                  Cond: Conditional
          - 
            label: "CDISC Notes"
            actions:
              -
                method: set_property
                object: child
                property: notes
                map: {}
    cdisc_term: 
      sheets: 
        version_1:
          selection:
            label: SDTM
          sheet:
            actions:
              -
                method: tag_from_sheet_name
                additional:
                  path: 
                    - "CDISC"
                map:
                  ADaM: 
                    - ADaM
                  CDASH: 
                    - CDASH
                  SDTM: 
                    - SDTM  
                  Protocol: 
                    - Protocol
                  SEND: 
                    - SEND
                  "QS T": 
                    - QS
                    - SDTM
                  "QS-FT T": 
                    - QS-FT
                    - SDTM
                  COA: 
                    - COA
                    - SDTM
                  QRS: 
                    - QRS
                    - SDTM
            header_row:
              - "Code"
              - "Codelist Code"
              - "Codelist Extensible (Yes/No)"
              - "Codelist Name" 
              - "CDISC Value" 
              - "NCI Preferred Term"
              - "CDISC Definition"
              - "CDISC Synonym(s) (where applicable)"
              - "Pre-release/ Production"
          columns: 
          - 
            label: "Code"
            actions:
              -
                method: c_code?
                object: NA
                klass: NA
                map: {}
              -
                method: create_parent
                object: parent
                klass: CdiscCl
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: set_property
                object: parent
                property: identifier
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: set_tags
                object: parent
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: create_child
                object: child
                klass: CdiscCli
                map: {}
                condition: 
                  method: column_blank?
                  column: 3
              -
                method: set_property
                object: child
                property: identifier
                map: {}
                condition: 
                  method: column_blank?
                  column: 3
              -
                method: set_tags
                object: child
                condition: 
                  method: column_blank?
                  column: 3
          - 
            label: "Codelist Code"
            actions:
              -
                method: c_code?
                object: NA
                klass: NA
                map: {}
          - 
            label: "Codelist Extensible (Yes/No)"
            actions: 
              -
                method: set_property
                object: parent
                property: extensible
                map: 
                  "Yes": true
                  "No": false
                condition: 
                  method: column_not_blank?
                  column: 3
          - 
            label: "Codelist Name" 
            actions:
              -
                method: set_property
                object: parent
                property: label
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 3
          - 
            label: "CDISC Value"
            actions:
              -
                method: set_property
                object: parent
                property: notation
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: set_property
                object: child
                property: notation
                map: {}
                condition: 
                  method: column_blank?
                  column: 3
          - 
            label: "NCI Preferred Term"
            actions:
              -
                method: create_shared
                object: parent
                property: preferred_term
                can_be_empty: false
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: create_shared
                object: child
                property: preferred_term
                can_be_empty: false
                map: {}
                condition: 
                  method: column_blank?
                  column: 3
              -
                method: set_property
                object: child
                property: label
                can_be_empty: false
                map: {}
                condition: 
                  method: column_blank?
                  column: 3
          - 
            label: "CDISC Definition"
            actions:
              -
                method: set_property
                object: parent
                property: definition
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: set_property
                object: child
                property: definition
                map: {}
                condition: 
                  method: column_blank?
                  column: 3
          -
            label: "CDISC Synonym(s) (where applicable)"
            actions:
              -
                method: tokenize_and_create_shared
                object: parent
                property: synonym
                can_be_empty: true
                map: {}
                additional: 
                  token: ";"
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: tokenize_and_create_shared
                object: child
                property: synonym
                can_be_empty: true
                map: {}
                additional: 
                  token: ";"
                condition: 
                  method: column_blank?
                  column: 3
          -
            label: Pre-release/ Production
            actions: []
        version_2:
          selection:
            label: SDTM
          sheet:
            actions:
              -
                method: tag_from_sheet_name
                additional:
                  path: 
                    - "CDISC"
                map:
                  ADaM: 
                    - ADaM
                  CDASH: 
                    - CDASH
                  SDTM: 
                    - SDTM  
                  Protocol: 
                    - Protocol
                  SEND: 
                    - SEND
                  "QS T": 
                    - QS
                    - SDTM
                  "QS-FT T": 
                    - QS-FT
                    - SDTM
                  COA: 
                    - COA
                    - SDTM
                  QRS: 
                    - QRS
                    - SDTM
            header_row:
              - "Code"
              - "Codelist Code"
              - "Codelist Extensible (Yes/No)"
              - "Codelist Name"
              - "CDISC Submission Value" 
              - "CDISC Preferred Term"
              - "CDISC Synonym(s)"
              - "CDISC Definition"
              - "NCI Preferred Term"
              - "Pre-release/ Production"
              - "Notes (Reference for CDISC PT)"
          columns: 
          - 
            label: "Code"
            actions:
              -
                method: c_code?
                object: NA
                klass: NA
                map: {}
              -
                method: create_parent
                object: parent
                klass: CdiscCl
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: set_property
                object: parent
                property: identifier
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: set_tags
                object: parent
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: create_child
                object: child
                klass: CdiscCli
                map: {}
                condition: 
                  method: column_blank?
                  column: 3
              -
                method: set_property
                object: child
                property: identifier
                map: {}
                condition: 
                  method: column_blank?
                  column: 3
              -
                method: set_tags
                object: child
                condition: 
                  method: column_blank?
                  column: 3
          - 
            label: "Codelist Code"
            actions:
              -
                method: c_code?
                object: NA
                klass: NA
                map: {}
          - 
            label: "Codelist Extensible (Yes/No)"
            actions: 
              -
                method: set_property
                object: parent
                property: extensible
                map: 
                  "Yes": true
                  "No": false
                condition: 
                  method: column_not_blank?
                  column: 3
          - 
            label: "Codelist Name" 
            actions:
              -
                method: set_property
                object: parent
                property: label
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 3
          - 
            label: "CDISC Submission Value"
            actions:
              -
                method: set_property
                object: parent
                property: notation
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: set_property
                object: child
                property: notation
                map: {}
                condition: 
                  method: column_blank?
                  column: 3
          - 
            label: "CDISC Preferred Term"
            actions: []
          -
            label: "CDISC Synonym(s)"
            actions:
              -
                method: tokenize_and_create_shared
                object: parent
                property: synonym
                can_be_empty: true
                map: {}
                additional: 
                  token: ";"
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: tokenize_and_create_shared
                object: child
                property: synonym
                can_be_empty: true
                map: {}
                additional: 
                  token: ";"
                condition: 
                  method: column_blank?
                  column: 3
          - 
            label: "CDISC Definition"
            actions:
              -
                method: set_property
                object: parent
                property: definition
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: set_property
                object: child
                property: definition
                map: {}
                condition: 
                  method: column_blank?
                  column: 3
          - 
            label: "NCI Preferred Term"
            actions:
              -
                method: create_shared
                object: parent
                property: preferred_term
                can_be_empty: false
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: create_shared
                object: child
                property: preferred_term
                can_be_empty: false
                map: {}
                condition: 
                  method: column_blank?
                  column: 3
              -
                method: set_property
                object: child
                property: label
                can_be_empty: false
                map: {}
                condition: 
                  method: column_blank?
                  column: 3
          -
            label: "Pre-release/ Production"
            actions: []
          -
            label: "Notes (Reference for CDISC PT)"
            actions: []
        version_3:
          selection:
            label: SDTM
          sheet:
            actions:
              -
                method: tag_from_sheet_name
                additional:
                  path: 
                    - "CDISC"
                map:
                  ADaM: 
                    - ADaM
                  CDASH: 
                    - CDASH
                  SDTM: 
                    - SDTM  
                  Protocol: 
                    - Protocol
                  SEND: 
                    - SEND
                  "QS T": 
                    - QS
                    - SDTM
                  "QS-FT T": 
                    - QS-FT
                    - SDTM
                  COA: 
                    - COA
                    - SDTM
                  QRS: 
                    - QRS
                    - SDTM
            header_row:
              - "Code"
              - "Codelist Code"
              - "Codelist Extensible (Yes/No)"
              - "Codelist Name" 
              - "CDISC Submission Value"
              - "CDISC Preferred Term"
              - "CDISC Synonym(s)"
              - "CDISC Definition"
              - "NCI Preferred Term"
              - "Pre-release/ Production"
              - "Notes (Reference for CDISC PT)"
          columns: 
          - 
            label: "Code"
            actions:
              -
                method: c_code?
                object: NA
                klass: NA
                map: {}
              -
                method: create_parent
                object: parent
                klass: CdiscCl
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: set_property
                object: parent
                property: identifier
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: set_tags
                object: parent
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: create_child
                object: child
                klass: CdiscCli
                map: {}
                condition: 
                  method: column_blank?
                  column: 3
              -
                method: set_property
                object: child
                property: identifier
                map: {}
                condition: 
                  method: column_blank?
                  column: 3
              -
                method: set_tags
                object: child
                condition: 
                  method: column_blank?
                  column: 3
          - 
            label: "Codelist Code"
            actions:
              -
                method: c_code?
                object: NA
                klass: NA
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 2
          - 
            label: "Codelist Extensible (Yes/No)"
            actions: 
              -
                method: set_property
                object: parent
                property: extensible
                map: 
                  "Yes": true
                  "No": false
                condition: 
                  method: column_blank?
                  column: 2
          - 
            label: "Codelist Name" 
            actions:
              -
                method: set_property
                object: parent
                property: label
                map: {}
                condition: 
                  method: column_blank?
                  column: 2
          - 
            label: "CDISC Submission Value"
            actions:
              -
                method: set_property
                object: parent
                property: notation
                map: {}
                condition: 
                  method: column_blank?
                  column: 2
              -
                method: set_property
                object: child
                property: notation
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 2
          - 
            label: "CDISC Preferred Term"
            actions: []
          -
            label: "CDISC Synonym(s)"
            actions:
              -
                method: tokenize_and_create_shared
                object: parent
                property: synonym
                can_be_empty: true
                map: {}
                additional: 
                  token: ";"
                condition: 
                  method: column_blank?
                  column: 2
              -
                method: tokenize_and_create_shared
                object: child
                property: synonym
                can_be_empty: true
                map: {}
                additional: 
                  token: ";"
                condition: 
                  method: column_not_blank?
                  column: 2
          - 
            label: "CDISC Definition"
            actions:
              -
                method: set_property
                object: parent
                property: definition
                map: {}
                condition: 
                  method: column_blank?
                  column: 2
              -
                method: set_property
                object: child
                property: definition
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 2
          - 
            label: "NCI Preferred Term"
            actions:
              -
                method: create_shared
                object: parent
                property: preferred_term
                can_be_empty: false
                map: {}
                condition: 
                  method: column_blank?
                  column: 2
              -
                method: create_shared
                object: child
                property: preferred_term
                can_be_empty: false
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 2
              -
                method: set_property
                object: child
                property: label
                can_be_empty: false
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 2
          -
            label: Pre-release/ Production
            actions: []
          -
            label: Notes (Reference for CDISC PT)
            actions: []
        version_4:
          selection:
            date: true
          sheet:
            actions:
              -
                method: tag_from_sheet_name
                additional:
                  path: 
                    - "CDISC"
                map:
                  ADaM: 
                    - ADaM
                  CDASH: 
                    - CDASH
                  SDTM: 
                    - SDTM  
                  Protocol: 
                    - Protocol
                  SEND: 
                    - SEND
                  "QS T": 
                    - QS
                    - SDTM
                  "QS-FT T": 
                    - QS-FT
                    - SDTM
                  COA: 
                    - COA
                    - SDTM
                  QRS: 
                    - QRS
                    - SDTM
            header_row:
              - "Code"
              - "Codelist Code"
              - "Codelist Extensible (Yes/No)"
              - "Codelist Name" 
              - "CDISC Submission Value"
              - "CDISC Preferred Term"
              - "CDISC Synonym(s)"
              - "CDISC Definition"
              - "NCI Preferred Term"
          columns: 
          - 
            label: "Code"
            actions:
              -
                method: c_code?
                object: NA
                klass: NA
                map: {}
              -
                method: create_parent
                object: parent
                klass: CdiscCl
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: set_property
                object: parent
                property: identifier
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: set_tags
                object: parent
                condition: 
                  method: column_not_blank?
                  column: 3
              -
                method: create_child
                object: child
                klass: CdiscCli
                map: {}
                condition: 
                  method: column_blank?
                  column: 3
              -
                method: set_property
                object: child
                property: identifier
                map: {}
                condition: 
                  method: column_blank?
                  column: 3
              -
                method: set_tags
                object: child
                condition: 
                  method: column_blank?
                  column: 3
          - 
            label: "Codelist Code"
            actions:
              -
                method: c_code?
                object: NA
                klass: NA
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 2
          - 
            label: "Codelist Extensible (Yes/No)"
            actions: 
              -
                method: set_property
                object: parent
                property: extensible
                map: 
                  "Yes": true
                  "No": false
                condition: 
                  method: column_blank?
                  column: 2
          - 
            label: "Codelist Name" 
            actions:
              -
                method: set_property
                object: parent
                property: label
                map: {}
                condition: 
                  method: column_blank?
                  column: 2
          - 
            label: "CDISC Submission Value"
            actions:
              -
                method: set_property
                object: parent
                property: notation
                map: {}
                condition: 
                  method: column_blank?
                  column: 2
              -
                method: set_property
                object: child
                property: notation
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 2
          - 
            label: "CDISC Preferred Term"
            actions: []
          -
            label: "CDISC Synonym(s)"
            actions:
              -
                method: tokenize_and_create_shared
                object: parent
                property: synonym
                can_be_empty: true
                map: {}
                additional: 
                  token: ";"
                condition: 
                  method: column_blank?
                  column: 2
              -
                method: tokenize_and_create_shared
                object: child
                property: synonym
                can_be_empty: true
                map: {}
                additional: 
                  token: ";"
                condition: 
                  method: column_not_blank?
                  column: 2
          - 
            label: "CDISC Definition"
            actions:
              -
                method: set_property
                object: parent
                property: definition
                map: {}
                condition: 
                  method: column_blank?
                  column: 2
              -
                method: set_property
                object: child
                property: definition
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 2
          - 
            label: "NCI Preferred Term"
            actions:
              -
                method: create_shared
                object: parent
                property: preferred_term
                can_be_empty: false
                map: {}
                condition: 
                  method: column_blank?
                  column: 2
              -
                method: create_shared
                object: child
                property: preferred_term
                can_be_empty: false
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 2
              -
                method: set_property
                object: child
                property: label
                can_be_empty: false
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 2
        version_5:
          selection:
            date: true
          sheet:
            actions:
              -
                method: tag_from_sheet_name
                additional:
                  path: 
                    - "CDISC"
                map:
                  ADaM: 
                    - ADaM
                  CDASH: 
                    - CDASH
                  SDTM: 
                    - SDTM  
                  Protocol: 
                    - Protocol
                  SEND: 
                    - SEND
                  "QS T": 
                    - QS
                    - SDTM
                  "QS-FT T": 
                    - QS-FT
                    - SDTM
                  COA: 
                    - COA
                    - SDTM
                  QRS: 
                    - QRS
                    - SDTM
                  "Def-XML":
                    - Define-XML
            header_row:
              - "Code"
              - "Codelist Code"
              - "Codelist Extensible (Yes/No)"
              - "Codelist Name" 
              - "CDISC Submission Value"
              - "CDISC Synonym(s)"
              - "CDISC Definition"
              - "NCI Preferred Term"
          columns: 
          - 
            label: "Code"
            actions:
              -
                method: c_code?
                object: NA
                klass: NA
                map: {}
              -
                method: create_parent
                object: parent
                klass: CdiscCl
                map: {}
                condition: 
                  method: column_blank?
                  column: 2
              -
                method: set_property
                object: parent
                property: identifier
                map: {}
                condition: 
                  method: column_blank?
                  column: 2
              -
                method: set_tags
                object: parent
                condition: 
                  method: column_blank?
                  column: 2
              -
                method: create_child
                object: child
                klass: CdiscCli
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 2
              -
                method: set_property
                object: child
                property: identifier
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 2
              -
                method: set_tags
                object: child
                condition: 
                  method: column_not_blank?
                  column: 2
          - 
            label: "Codelist Code"
            actions:
              -
                method: c_code?
                object: NA
                klass: NA
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 2
          - 
            label: "Codelist Extensible (Yes/No)"
            actions: 
              -
                method: set_property
                object: parent
                property: extensible
                map: 
                  "Yes": true
                  "No": false
                  "NA": false
                condition: 
                  method: column_blank?
                  column: 2
          - 
            label: "Codelist Name" 
            actions:
              -
                method: set_property
                object: parent
                property: label
                map: {}
                condition: 
                  method: column_blank?
                  column: 2
          - 
            label: "CDISC Submission Value"
            actions:
              -
                method: set_property
                object: parent
                property: notation
                map: {}
                condition: 
                  method: column_blank?
                  column: 2
              -
                method: set_property
                object: child
                property: notation
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 2
          -
            label: "CDISC Synonym(s)"
            actions:
              -
                method: tokenize_and_create_shared
                object: parent
                property: synonym
                can_be_empty: true
                map: {}
                additional: 
                  token: ";"
                condition: 
                  method: column_blank?
                  column: 2
              -
                method: tokenize_and_create_shared
                object: child
                property: synonym
                can_be_empty: true
                map: {}
                additional: 
                  token: ";"
                condition: 
                  method: column_not_blank?
                  column: 2
          - 
            label: "CDISC Definition"
            actions:
              -
                method: set_property
                object: parent
                property: definition
                map: {}
                condition: 
                  method: column_blank?
                  column: 2
              -
                method: set_property
                object: child
                property: definition
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 2
          - 
            label: "NCI Preferred Term"
            actions:
              -
                method: create_shared
                object: parent
                property: preferred_term
                can_be_empty: false
                map: {}
                condition: 
                  method: column_blank?
                  column: 2
              -
                method: create_shared
                object: child
                property: preferred_term
                can_be_empty: false
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 2
              -
                method: set_property
                object: child
                property: label
                can_be_empty: false
                map: {}
                condition: 
                  method: column_not_blank?
                  column: 2
    sponsor_term_format_one: 
      sheets: 
        version_2:
          selection:
            first: true
          sheet:
            actions:
              -
                method: tag_from_sheet_name
                additional:
                  path: 
                    - "Process"
                    - "Scope"
                map:
                  Harmonized: 
                    - Global
                  Study: 
                    - Study
            header_row:
              - "CODELIST_LONG_NAME"
              - "CODELIST_SHORT_NAME"
              - "CODELIST_EXTENSIBLE"
              - "CODELIST_DEFINITION"
              - "CODELIST_CODE"
              - "CODE"
              - "SUBMISSION_VALUE"
              - "DECODE"
              - "SYNONYM"
              - "CODE_DEFINITION"
              - "DATA_TYPE"
              - "CRF_DISPLAY_VALUE"
              - "DISPLAY_ORDER"
              - "RANK"
              - "DC_STAGE"
              - "SDTM_STAGE"
              - "ADAM_STAGE"
              - "INACTIVE_F"
              - "STUDY_USE"
              - "GLOBAL_USE"
          columns: 
          - 
            label: "CODELIST_SHORT_NAME"
            actions:
              -
                method: create_parent
                object: parent
                klass: Import::STFOClasses::STFOCodeList
                map: {}
              -
                method: set_property
                object: parent
                property: notation
                map: {}
          - 
            label: "CODELIST_CODE"
            actions:
              -
                method: regex?
                object: NA
                additional: 
                  regex: "\\ASN[0-9]{6}|C[0-9]{3,6}\\z"
              -
                method: set_property
                object: parent
                property: identifier
                map: {}
          - 
            label: "CODELIST_LONG_NAME"
            actions:
              -
                method: set_property
                object: parent
                property: label
                map: {}
              -
                method: create_shared
                object: parent
                property: preferred_term
                can_be_empty: false
                map: {}
          -
            label: "CODELIST_EXTENSIBLE"
            actions: 
              -
                method: set_property
                object: parent
                property: extensible
                map: 
                  "Yes": true
                  "No": false
          - 
            label: "CODELIST_DEFINITION"
            actions:
              -
                method: set_property
                object: parent
                property: definition
                map: {}
          - 
            label: "CODE"
            actions: 
              -
                method: regex?
                object: NA
                additional: 
                  regex: "\\AS[0-9]{6}|SC[0-9]{3,6}|C[0-9]{3,6}\\z"
              -
                method: create_child
                object: child
                klass: Import::STFOClasses::STFOCodeListItem
                map: {}
              -
                method: set_property
                object: child
                property: identifier
                map: {}
          - 
            label: "SUBMISSION_VALUE"
            actions: 
              -
                method: set_property
                object: child
                property: notation
                map: {}
              -
                method: create_shared
                object: child
                property: preferred_term
                map: {}
                condition: 
                  method: column_blank?
                  column: 
                    - 8
                    - 12
          - 
            label: "DECODE"
            actions: 
              -
                method: create_shared
                object: child
                property: preferred_term
                can_be_empty: true
                map: {}
          - 
            label: "SYNONYM"
            actions: 
              -
                method: tokenize_and_create_shared
                object: child
                property: synonym
                can_be_empty: true
                map: {}
                additional: 
                  token: ";"
          - 
            label: "CODE_DEFINITION"
            actions:
              -
                method: set_property_with_default
                object: child
                property: definition
                map: {}
                additional:
                  default: "Not defined."
          - 
            label: "DATA_TYPE"
            actions: []
          - 
            label: "CRF_DISPLAY_VALUE"
            actions:
              -
                method: create_shared
                object: child
                property: preferred_term
                can_be_empty: true
                map: {}
                condition: 
                  method: column_blank?
                  column: 8
          - 
            label: "DISPLAY_ORDER"
            actions:  []
          - 
            label: "RANK"
            actions: []
          - 
            label: "DC_STAGE"
            actions: 
              -
                method: set_column_tag
                object: parent
                map:
                  "Y": "DC Stage"
                  "N": ""
                additional:
                  path:
                    - Process 
                    - Stage
              -
                method: set_column_tag
                object: child
                map:
                  "Y": "DC Stage"
                  "N": ""
                additional:
                  path:
                    - Process 
                    - Stage
          - 
            label: "SDTM_STAGE"
            actions: 
              -
                method: set_column_tag
                object: parent
                map:
                  "Y": "SDTM Stage"
                  "N": ""
                additional:
                  path:
                    - Process 
                    - Stage
              -
                method: set_column_tag
                object: child
                map:
                  "Y": "SDTM Stage"
                  "N": ""
                additional:
                  path:
                    - Process 
                    - Stage          
          - 
            label: "ADAM_STAGE"
            actions: 
              -
                method: set_column_tag
                object: parent
                map:
                  "Y": "ADaM Stage"
                  "N": ""
                additional:
                  path:
                    - Process 
                    - Stage
              -
                method: set_column_tag
                object: child
                map:
                  "Y": "ADaM Stage"
                  "N": ""
                additional:
                  path:
                    - Process 
                    - Stage       
          - 
            label: "INACTIVE_F"
            actions: []
          - 
            label: "STUDY_USE"
            actions: 
              -
                method: set_column_tag
                object: child
                can_be_empty: true
                map:
                  "Y": "Study"
                additional:
                  path:
                    - Process 
                    - Scope
          - 
            label: "GLOBAL_USE"
            actions: 
              -
                method: set_column_tag
                object: child
                can_be_empty: true
                map:
                  "Y": "Global"
                  "N": ""
                additional:
                  path:
                    - Process 
                    - Scope
        version_3:
          selection:
            first: true
          sheet:
            actions:
              -
                method: tag_from_sheet_name
                additional:
                  path: 
                    - "Process"
                    - "Scope"
                map:
                  Harmonized: 
                    - Global
                  Study: 
                    - Study
            header_row:
              - "CODELIST_LONG_NAME"
              - "CODELIST_SHORT_NAME"
              - "CODELIST_EXTENSIBLE"
              - "CODELIST_DEFINITION"
              - "CODELIST_CODE"
              - "CODE"
              - "SUBMISSION_VALUE"
              - "DECODE"
              - "SYNONYM"
              - "CODE_DEFINITION"
              - "DATA_TYPE"
              - "CRF_DISPLAY_VALUE"
              - "DISPLAY_ORDER"
              - "RANK"
              - "CRFGL_USE"
              - "SDTM_USE"
              - "ADAM_USE"
              - "ED_USE"
              - "STUDY_USE"
              - "INACTIVE_F"
          columns: 
          - 
            label: "CODELIST_SHORT_NAME"
            actions:
              -
                method: create_parent
                object: parent
                klass: Import::STFOClasses::STFOCodeList
                map: {}
              -
                method: set_property
                object: parent
                property: notation
                map: {}
          - 
            label: "CODELIST_CODE"
            actions:
              -
                method: regex?
                object: NA
                additional: 
                  regex: "\\ASN[0-9]{6}|C[0-9]{3,6}\\z"
              -
                method: set_property
                object: parent
                property: identifier
                map: {}
          - 
            label: "CODELIST_LONG_NAME"
            actions:
              -
                method: set_property
                object: parent
                property: label
                map: {}
              -
                method: create_shared
                object: parent
                property: preferred_term
                map: {}
          -
            label: "CODELIST_EXTENSIBLE"
            actions: 
              -
                method: set_property
                object: parent
                property: extensible
                map: 
                  "Yes": true
                  "No": false
          - 
            label: "CODELIST_DEFINITION"
            actions:
              -
                method: set_property
                object: parent
                property: definition
                map: {}
          - 
            label: "CODE"
            actions: 
              -
                method: regex?
                object: NA
                additional: 
                  regex: "\\AS[0-9]{6}|SC[0-9]{3,6}|C[0-9]{3,6}\\z"
              -
                method: create_child
                object: child
                klass: Import::STFOClasses::STFOCodeListItem
                map: {}
              -
                method: set_property
                object: child
                property: identifier
                map: {}
          - 
            label: "SUBMISSION_VALUE"
            actions: 
              -
                method: set_property
                object: child
                property: notation
                map: {}
              -
                method: create_shared
                object: child
                property: preferred_term
                map: {}
                condition: 
                  method: column_blank?
                  column: 
                    - 8
                    - 12
          - 
            label: "DECODE"
            actions: 
              -
                method: create_shared
                object: child
                property: preferred_term
                can_be_empty: true
                map: {}
          - 
            label: "SYNONYM"
            actions: 
              -
                method: tokenize_and_create_shared
                object: child
                property: synonym
                can_be_empty: true
                map: {}
                additional: 
                  token: ";"
          - 
            label: "CODE_DEFINITION"
            actions:
              -
                method: set_property_with_default
                object: child
                property: definition
                map: {}
                additional:
                  default: "Not defined."
          - 
            label: "DATA_TYPE"
            actions: []
          - 
            label: "CRF_DISPLAY_VALUE"
            actions:
              -
                method: create_shared
                object: child
                property: preferred_term
                can_be_empty: true
                map: {}
                condition: 
                  method: column_blank?
                  column: 8
          - 
            label: "DISPLAY_ORDER"
            actions: []
          - 
            label: "RANK"
            actions: []
          - 
            label: "CRFGL_USE"
            actions: 
              -
                method: set_column_tag
                object: parent
                map:
                  "Y": "CRF GL Use"
                  "N": ""
                additional:
                  path:
                    - Process 
                    - Use
              -
                method: set_column_tag
                object: child
                map:
                  "Y": "CRF GL Use"
                  "N": ""
                additional:
                  path:
                    - Process 
                    - Use
          - 
            label: "SDTM_USE"
            actions: 
              -
                method: set_column_tag
                object: parent
                map:
                  "Y": "SDTM Use"
                  "N": ""
                additional:
                  path:
                    - Process 
                    - Use
              -
                method: set_column_tag
                object: child
                map:
                  "Y": "SDTM Use"
                  "N": ""
                additional:
                  path:
                    - Process 
                    - Use
          - 
            label: "ADAM_USE"
            actions: 
              -
                method: set_column_tag
                object: parent
                map:
                  "Y": "ADaM Use"
                  "N": ""
                additional:
                  path:
                    - Process 
                    - Use
              -
                method: set_column_tag
                object: child
                map:
                  "Y": "ADaM Use"
                  "N": ""
                additional:
                  path:
                    - Process 
                    - Use
          - 
            label: "ED_USE"
            actions: 
              -
                method: set_column_tag
                object: parent
                can_be_empty: true
                map:
                  "Y": "ED Use"
                  "N": ""
                additional:
                  path:
                    - Process 
                    - Use
              -
                method: set_column_tag
                object: child
                can_be_empty: true
                map:
                  "Y": "ED Use"
                  "N": ""
                additional:
                  path:
                    - Process 
                    - Use
          - 
            label: "STUDY_USE"
            actions: 
              -
                method: set_column_tag
                object: parent
                can_be_empty: true
                map:
                  "Y": "Study Use"
                  "N": ""
                additional:
                  path:
                    - Process 
                    - Use
              -
                method: set_column_tag
                object: child
                can_be_empty: true
                map:
                  "Y": "Study Use"
                  "N": ""
                additional:
                  path:
                    - Process 
                    - Use
          - 
            label: "INACTIVE_F"
            actions: []
    cdisc_library_api:
      base_href: "https://library.cdisc.org/api/"
      ct:
        products:
          ADaM:
            label: ADaM
            tags: 
              - ADaM
            from: 2010-05-03
            to: 2100-01-01
          CDASH:
            label: CDASH
            tags: 
              - CDASH
            from: 2010-05-03
            to: 2100-01-01
          SDTM:
            label: SDTM  
            tags: 
              - SDTM
            from: 2007-03-06
            to: 2100-01-01
          Protocol:
            label: Protocol
            tags: 
              - Protocol
            from: 2017-06-30
            to: 2100-01-01
          SEND:
            label: SEND
            tags: 
              - SEND
            from: 2011-06-10
            to: 2100-01-01
          "QS-FT":
            label: QS-FT
            tags:                     
              - QS-FT
              - SDTM
            from: 2011-06-10
            to: 2014-10-06
          QRS:
            label: QRS
            tags:                     
              - QRS
              - SDTM
            from: 2015-06-26
            to: 2015-09-25
          COA:
            label: COA
            tags:                     
              - COA
              - SDTM
            from: 2014-12-19
            to: 2015-03-27
          Define:
            label: Define-XML
            tags: 
              - Define-XML
            from: 2019-12-20
            to: 2100-01-01

development:
  <<: *defaults

production: 
  <<: *defaults
  
test: 
  imports:
    <<: *default_imports
    test_1:
      title: Test 1 - Excel
      background: true
      description: A test
      link_text: "Import ADaM IG"
      link_path: "/imports/adam_igs/new?imports[file_type]=0"
    test_2:
      title: Test 2 - Excel
      background: true
      description: A test
      link_text: "Import ADaM IG"
      link_path: "/imports/adam_igs/new?imports[file_type]=0"
  processing:
    <<: *default_processing
    test_1:
      sheets: 
        sheet_1:
          selection:
            label: Sheet1
          sheet:
            header_row:
              - "PARENT"
              - "CHILD"
              - "CT"
              - "DATATYPE"
              - "CORE"
          columns: 
          - 
            label: "PARENT"
            actions:
              -
                method: create_parent
                object: parent
                klass: ParentClass
                map:
                  P1: P1
                  P2: P2
              -
                method: set_property
                object: parent
                property: label
                map:
                  P1: Parent One
                  P2: Parent Two
          - 
            label: CHILD
            actions:
              -
                method: create_child
                object: child
                klass: ChildClass
                map: {}
              -
                method: ordinal
                object: child
                property: ordinal
                map: {}
              -
                method: set_property
                object: child
                property: label
                map: {}
          - 
            label: CT
            actions:
              - 
                method: ct_reference
                object: child
                property: ct
                map: {}
              -
                method: ct_other
                object: child
                property: ct_notes
                map: {}
          - 
            label: DATATYPE
            actions:
              -
                method: create_classification
                object: child
                property: datatype
                map:
                  CHAR: Character
                  NUM: Numeric
          - 
            label: CORE
            actions:
              -
                method: create_classification
                object: child
                property: compliance
                map:
                  R: Required
                  P: Permissible
                  E: Conditional
    test_2:
      sheets: 
        sheet_1:
          selection:
            label: Sheet1
          sheet:
            header_row:
              - "PARENT"
              - "CHILD"
              - "CT"
              - "DATATYPE"
              - "CORE"
          columns: 
          - 
            label: "PARENT"
            actions:
              -
                method: create_parent
                object: parent
                klass: ParentClass
                map:
                  X1: Parent One
                  X2: Parent Two
              -
                method: set_property
                object: parent
                property: label
                map:
                  X1: Parent One
                  X2: Parent Two
          - 
            label: CHILD
            actions:
              -
                method: create_child
                object: child
                klass: ChildClass
                map: {}
              -
                method: ordinal
                object: child
                property: ordinal
                map: {}
              -
                method: set_property
                object: child
                property: label
                map: {}
          - 
            label: CT
            actions:
              - 
                method: ct_reference
                object: child
                property: ct
                map: {}
              -
                method: ct_other
                object: child
                property: ct_notes
                map: {}
          - 
            label: DATATYPE
            actions:
              -
                method: create_classification
                object: child
                property: datatype
                map:
                  CHAR: Character
                  NUM: Numeric
          - 
            label: CORE
            actions:
              -
                method: create_classification
                object: child
                property: compliance
                map:
                  R: Required
                  P: Permissible
                  E: Conditional
    test_3:
      sheets: 
        sheet_1:
          selection:
            label: hee # Note short name
          sheet:
            header_row:
              - "PARENT"
              - "CHILD"
              - "CT"
              - "DATATYPE"
              - "CORE"
          columns: 
          - 
            label: "PARENT"
            actions:
              -
                method: create_parent
                object: parent
                klass: ParentClass
                map:
                  P1: P1
                  P2: P2
              -
                method: set_property
                object: parent
                property: label
                map:
                  P1: Parent One
                  P2: Parent Two
          - 
            label: CHILD
            actions:
              -
                method: create_child
                object: child
                klass: ChildClass
                map: {}
              -
                method: ordinal
                object: child
                property: ordinal
                map: {}
              -
                method: set_property
                object: child
                property: label
                map: {}
          - 
            label: CT
            actions:
              - 
                method: ct_reference
                object: child
                property: ct
                map: {}
              -
                method: ct_other
                object: child
                property: ct_notes
                map: {}
                condition: 
                  method: column_blank?
                  column: 3
          - 
            label: DATATYPE
            actions:
              -
                method: create_classification
                object: child
                property: datatype
                map:
                  CHAR: Character
                  NUM: Numeric
          - 
            label: CORE
            actions:
              -
                method: create_classification
                object: child
                property: compliance
                map:
                  R: Required
                  P: Permissible
                  E: Conditional
    test_4:
      sheets: 
        sheet_1:
          selection:
            label: hee # Note short name
          sheet: 
            header_row: []
          columns: [] 
    test_5:
      sheets: 
        sheet_1:
          selection:
            date: true
          sheet: 
            header_row: []
          columns: [] 
    test_6:
      sheets: 
        sheet_1:
          selection:
            first: true
          sheet: 
            header_row: []
          columns: [] 
    test_7:
      sheets: 
        sheet_1:
          selection:
            wrong: method
          sheet: 
            header_row: []
          columns: [] 
    test_8:
      sheets: 
        sheet_1:
          selection:
            label: Sheet1
          row:
            condition:
              method: column_affirmative?
              column: 3 
          sheet: 
            header_row: []
          columns: [] 
